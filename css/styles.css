:root{
  --bg: #f7f7f9;
  --surface: #ffffff;
  --text: #111827;
  --muted: #6b7280;
  --primary: #1d4ed8;
  --accent: #10b981;
  --border: #e5e7eb;
  --shadow: 0 10px 25px rgba(0,0,0,.08);
  --transition: 200ms ease;
  --header-offset: 84px; /* dynamically updated in JS for accurate anchor offset */
}

html[data-theme="dark"]{
  --bg: #0b0f14;
  --surface: #0f1620;
  --text: #e5e7eb;
  --muted: #9ca3af;
  --primary: #60a5fa;
  --accent: #34d399;
  --border: #1f2937;
  --shadow: 0 10px 30px rgba(0,0,0,.4);
}

*{ box-sizing: border-box; }
html,body{ height:100%; }
html { scroll-behavior: smooth; }
body{
  margin:0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
  color: var(--text);
  background: var(--bg);
  line-height: 1.6;
  transition: background-color var(--transition), color var(--transition);
}

/* Utilities */
.container{ width:min(1100px, 92%); margin-inline:auto; }
.section{ padding: 64px 0; scroll-margin-top: var(--header-offset); }
.section-title{
  font-size: clamp(1.6rem, 1.1rem + 1.5vw, 2rem);
  margin: 0 0 24px;
  transition: color var(--transition);
}
.link{ color: var(--primary); text-decoration: underline; }

/* Header & Nav */
.site-header{
  position: sticky; top: 0; z-index: 50;
  background: color-mix(in oklab, var(--surface) 92%, transparent);
  backdrop-filter: blur(10px);
  border-bottom: 1px solid var(--border);
  transition: background-color var(--transition), border-color var(--transition), box-shadow var(--transition), color var(--transition);
}

/* Fallback (if sticky is unreliable, JS will add .is-fixed) */
.site-header.is-fixed{
  position: fixed; top: 0; left: 0; right: 0;
}

.header-inner{
  display: grid; grid-template-columns: 1fr auto auto; align-items: center; gap: 16px;
  padding: 14px 0;
}
.brand .name{ margin: 0; font-size: 1.4rem; transition: color var(--transition); }
.brand .title{ margin: 2px 0 0; color: var(--muted); font-size: .95rem; transition: color var(--transition); }

.primary-nav ul{ list-style: none; display:flex; gap: 16px; margin:0; padding:0; }
.primary-nav a{
  color: var(--text); text-decoration: none; padding: 8px 10px; border-radius: 10px;
  transition: background-color var(--transition), color var(--transition);
}
.primary-nav a.active{ background: color-mix(in oklab, var(--primary) 15%, transparent); color: var(--primary); }

.header-actions{ display:flex; align-items:center; gap:8px; }
.btn{
  padding: 8px 12px; border: 1px solid var(--border); background: var(--surface); color: var(--text);
  border-radius: 10px; cursor: pointer; transition: transform var(--transition), background-color var(--transition), border-color var(--transition), color var(--transition);
}
.btn:hover{ transform: translateY(-1px); }
.theme-btn{ font-weight: 600; }

/* Mobile nav */
.nav-toggle{
  display:none; position:relative; width:40px; height:40px; border:1px solid var(--border);
  border-radius: 10px; background: var(--surface); cursor: pointer; transition: border-color var(--transition), background-color var(--transition);
}
.nav-toggle-bar{ position:absolute; inset:0; margin:auto; width:22px; height:2px; background: var(--text); box-shadow: 0 6px 0 var(--text), 0 -6px 0 var(--text); transition: background-color var(--transition), box-shadow var(--transition); }
.sr-only{ position:absolute; width:1px; height:1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0; padding:0; }

@media (max-width: 860px){
  .header-inner{ grid-template-columns: 1fr auto auto; }
  .nav-toggle{ display:block; }
  .primary-nav{ display:none; }
  .primary-nav.open{ display:block; position:absolute; top: 64px; right: 4%; background: var(--surface); border:1px solid var(--border); border-radius: 12px; box-shadow: var(--shadow); }
  .primary-nav ul{ flex-direction: column; padding: 8px; }
}

/* Summary */
.greeting{ margin: 0 0 8px; color: var(--primary); font-weight: 700; }
.intro{ margin: 0 0 8px; transition: color var(--transition); }
.hover-fade{ position:relative; display:inline-block; }
.hover-fade::after{
  content:""; position:absolute; left:0; right:0; bottom:-2px; height:2px; background: var(--accent);
  transform: scaleX(0); transform-origin:left; transition: transform 260ms ease;
}
.hover-fade:hover::after{ transform: scaleX(1); }

/* Experience */
.section-experience .job{
  border:1px solid var(--border); background: var(--surface); border-radius: 14px; padding: 16px 18px; box-shadow: var(--shadow); margin-bottom: 16px;
  opacity: 0; transform: translateY(18px);
  transition: opacity 600ms ease, transform 600ms ease, background-color var(--transition), border-color var(--transition);
}
.section-experience .job.visible{ opacity:1; transform:none; }
.job-header{ display:flex; flex-direction: column; gap: 4px; margin-bottom: 8px; }
.job-title{ margin:0; font-size: 1.1rem; }
.job-meta{ margin:0; color: var(--muted); }
.responsibilities{ padding-left: 20px; }
.has-tip{ position:relative; cursor:help; border-bottom: 1px dashed var(--muted); }

/* Tooltip (JS injected) */
.tooltip{
  position: fixed; z-index: 1000; pointer-events:none; transform: translate(-50%, -125%);
  background: var(--surface); color: var(--text); border: 1px solid var(--border); border-radius: 8px; 
  padding: 6px 8px; font-size: .9rem; box-shadow: var(--shadow);
  transition: background-color var(--transition), color var(--transition), border-color var(--transition);
}

/* Education */
.edu-controls{ margin-bottom: 10px; display:flex; justify-content:flex-end; }
.edu-table-wrap{ overflow-x:auto; background: var(--surface); border:1px solid var(--border); border-radius: 12px; transition: background-color var(--transition), border-color var(--transition); }
.edu-table{ width:100%; border-collapse: collapse; }
.edu-table th, .edu-table td{ padding: 12px; border-bottom:1px solid var(--border); text-align:left; vertical-align: middle; }
.edu-logo{ width: 28px; height: 28px; object-fit: contain; vertical-align: middle; margin-right: 8px; transition: transform 200ms ease; }
.edu-logo:hover{ transform: scale(2.15); }

/* Skills */
.skills-toggle{ display:flex; gap: 8px; margin-bottom: 12px; flex-wrap: wrap; }
.chip{
  border:1px solid var(--border); background: var(--surface); color: var(--text); border-radius: 999px; padding: 6px 12px; cursor: pointer;
  transition: background-color var(--transition), border-color var(--transition), color var(--transition), transform var(--transition);
}
.chip:hover{ transform: translateY(-1px); }
.chip.is-active{ background: color-mix(in oklab, var(--primary) 12%, var(--surface)); color: var(--primary); border-color: color-mix(in oklab, var(--primary) 25%, var(--border)); }

.skill-group{
  border:1px solid var(--border); padding: 12px 14px; border-radius: 12px; margin-bottom: 12px; background: var(--surface);
  transition: background-color var(--transition), border-color var(--transition);
}
.skill-group legend{ padding: 0 8px; color: var(--muted); }
.skill{ display:grid; grid-template-columns: 140px 1fr auto; align-items:center; gap: 12px; margin: 10px 0; }
progress, meter{ width:100%; height: 16px; }
progress::-webkit-progress-bar{ background: #e5e7eb; border-radius: 10px; }
progress::-webkit-progress-value{ background: var(--primary); border-radius: 10px; }
meter{ background: #e5e7eb; }
meter::-webkit-meter-bar{ background: #e5e7eb; border-radius: 10px; }
meter::-webkit-meter-optimum-value{ background: var(--primary); border-radius: 10px; }
.skill-value{ font-variant-numeric: tabular-nums; color: var(--muted); }


/* ===== Projects ===== */
.project-filters{ display:flex; gap:8px; margin-bottom:14px; flex-wrap:wrap; }
.project-grid{ display:grid; grid-template-columns:repeat(3,1fr); gap:16px; }
@media (max-width:980px){ .project-grid{ grid-template-columns:repeat(2,1fr); } }
@media (max-width:620px){ .project-grid{ grid-template-columns:1fr; } }

/* Chips */
.chip{
  border:1px solid var(--border);
  background: var(--surface);
  color: var(--text);
  border-radius:999px;
  padding:6px 12px;
  cursor:pointer;
  transition: background-color var(--transition), border-color var(--transition), color var(--transition), transform var(--transition);
}
.chip:hover{ transform: translateY(-1px); }
.chip.is-active{
  background: color-mix(in oklab, var(--primary) 12%, var(--surface));
  color: var(--primary);
  border-color: color-mix(in oklab, var(--primary) 25%, var(--border));
}

/* Flip card */
.flip-card{ perspective:1200px; -webkit-perspective:1200px; }
.flip-card-inner{
  position:relative;
  transform-style:preserve-3d; -webkit-transform-style:preserve-3d;
  transition:transform 600ms ease;
  border:1px solid var(--border);
  border-radius:14px;
  overflow:hidden;
  background:var(--surface);
  box-shadow:var(--shadow);
  aspect-ratio: 4 / 3;   /* responsive height */
  min-height: 260px;
}

/* IMPORTANT: Only flip via JS state */
.flip-card.is-flipped .flip-card-inner{ transform: rotateY(180deg); }

/* Faces */
.flip-card-front,
.flip-card-back{
  position:absolute; inset:0;
  display:flex; flex-direction:column; align-items:center; justify-content:center;
  gap:10px; padding:14px;
  backface-visibility:hidden; -webkit-backface-visibility:hidden;
  transform: translateZ(0); /* fixes Safari paint glitches */
}

/* Back face above when flipped */
.flip-card-back{
  transform: rotateY(180deg);
  z-index: 1;
  background: var(--surface);
  overflow:auto; /* scroll if content taller */
}

/* Hide front HARD when flipped so video can’t “shine through” */
.flip-card.is-flipped .flip-card-front{
  opacity: 0 !important;
  visibility: hidden !important;
  pointer-events: none !important;
}
.flip-card.is-flipped .flip-card-back{
  opacity: 1 !important;
  visibility: visible !important;
  z-index: 2 !important;
}

/* Media */
.flip-card-front img{ width:100%; height:60%; object-fit:cover; border-radius:10px; }
.iframe-wrap{ position:relative; width:100%; padding-top:56.25%; border-radius:10px; overflow:hidden; }
.iframe-wrap video, .iframe-wrap iframe{
  position:absolute; inset:0; width:100%; height:100%; border:0; object-fit:cover;
  backface-visibility:hidden; -webkit-backface-visibility:hidden;
}

/* Back content */
.project-meta{ margin:0; width:100%; }
.project-meta dt{ font-weight:600; }
.project-meta dd{ margin:0 0 8px; color:var(--muted); }
.project-name{ margin:6px 0 0; text-align:center; }


/* Certifications */
.cert-list{ display:grid; gap: 12px; margin: 0; }
.cert-item{ display:grid; grid-template-columns: 240px 1fr; gap: 10px; border:1px solid var(--border); background: var(--surface); border-radius: 12px; padding: 12px;
  transition: background-color var(--transition), border-color var(--transition);
}

/* Highlight + pulse already existed; keeping it, just annotating */
.badge-pulse{
  position: relative; border-color: color-mix(in oklab, var(--accent) 40%, var(--border));
}
.badge-pulse::after{
  content:""; position:absolute; inset:-6px; border-radius: 14px; border: 2px solid color-mix(in oklab, var(--accent) 70%, transparent);
  animation: pulse 1.5s ease-in-out infinite;
}
@keyframes pulse{
  0%{ opacity:.4; transform: scale(1); }
  70%{ opacity:0; transform: scale(1.05); }
  100%{ opacity:0; transform: scale(1.05); }
}

/* Interests */
.gallery{ display:grid; grid-template-columns: repeat(3, 1fr); gap: 16px; }
@media (max-width: 900px){ .gallery{ grid-template-columns: 1fr 1fr; } }
@media (max-width: 560px){ .gallery{ grid-template-columns: 1fr; } }
.gallery-item{
  margin:0; border-radius: 12px; overflow: hidden; border:1px solid var(--border); background: var(--surface); box-shadow: var(--shadow);
  cursor: pointer; transform: translateZ(0);
  transition: background-color var(--transition), border-color var(--transition), box-shadow var(--transition);
}
.gallery-item img{ display:block; width:100%; height: 190px; object-fit: cover; transition: transform 400ms ease; }
.gallery-item:hover img{ transform: scale(1.05) rotate(.3deg); }
.gallery-item figcaption{ padding: 10px 12px; color: var(--muted); }

/* Modal */
.modal{ position: fixed; inset:0; display:none; align-items: center; justify-content: center; }
.modal.open{ display:flex; }
.modal-backdrop{ position:absolute; inset:0; background: rgba(0,0,0,.48); }
.modal-content{
  position:relative; z-index:1; width:min(720px, 92%); background: var(--surface); border:1px solid var(--border);
  border-radius: 14px; padding: 16px; color: var(--text); box-shadow: var(--shadow);
  transition: background-color var(--transition), border-color var(--transition), color var(--transition);
}
.modal-content img{ display:block; width:100%; border-radius: 10px; margin: 8px 0; }
.modal-close{
  position:absolute; top: 8px; right: 8px; background: var(--surface); border:1px solid var(--border);
  border-radius: 8px; width:32px; height:32px; cursor:pointer;
  transition: background-color var(--transition), border-color var(--transition), color var(--transition);
}

/* Contact wrapper (kept) */
.section-contact .container{
  background: var(--surface); border:1px solid var(--border); border-radius: 14px; padding: 18px; box-shadow: var(--shadow);
  transition: background-color var(--transition), border-color var(--transition);
}

/* Back to top */
.back-to-top{
  position: fixed; right: 16px; bottom: 16px; width: 44px; height: 44px; border-radius: 12px; border:1px solid var(--border);
  background: var(--surface); box-shadow: var(--shadow); display: grid; place-items: center; opacity:0; pointer-events:none;
  transition: opacity var(--transition), transform var(--transition), background-color var(--transition), border-color var(--transition);
}
.back-to-top.visible{ opacity:1; pointer-events:auto; }
.arrow-up{ width: 20px; height: 20px; fill: var(--primary); }

/* Sticky header shadow when scrolled */
.site-header.is-sticky{ box-shadow: var(--shadow); }

/* Footer fade-in on visible */
.site-footer{
  opacity: 0; transform: translateY(16px);
  transition: opacity 500ms ease, transform 500ms ease, background-color var(--transition), color var(--transition), border-color var(--transition);
}
.site-footer.visible{ opacity: 1; transform: none; }
